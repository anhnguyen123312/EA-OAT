# SMC/ICT Expert Advisor v2.1 - T√†i Li·ªáu Kinh Doanh

## üìç T·ªïng Quan

ƒê√¢y l√† th∆∞ m·ª•c **T√†i Li·ªáu Kinh Doanh/Chi·∫øn L∆∞·ª£c**, d√†nh cho trader v√† ng∆∞·ªùi l·∫≠p chi·∫øn l∆∞·ª£c.

Bot EA t·ª± ƒë·ªông giao d·ªãch XAUUSD d·ª±a tr√™n ph∆∞∆°ng ph√°p **SMC (Smart Money Concepts) / ICT (Inner Circle Trader)**.

### üéØ M·ª•c Ti√™u
- Ph√°t hi·ªán c√°c setup giao d·ªãch ch·∫•t l∆∞·ª£ng cao theo SMC/ICT
- Qu·∫£n l√Ω v·ªã th·∫ø t·ª± ƒë·ªông v·ªõi DCA, Breakeven, Trailing Stop
- B·∫£o v·ªá v·ªën v·ªõi Daily MDD limit v√† risk management
- T·ªëi ∆∞u l·ª£i nhu·∫≠n v·ªõi dynamic lot sizing v√† basket management

### üìä Th·ªã Tr∆∞·ªùng & Timeframe
- **C√¥ng c·ª• giao d·ªãch**: XAUUSD (V√†ng)
- **Timeframe ch√≠nh**: M15 / M30
- **Timeframe cao h∆°n**: H1 / H4 (cho ph√¢n t√≠ch MTF)

---

## üìö M·ª•c L·ª•c T√†i Li·ªáu

### ‚≠ê Quy T·∫Øc Giao D·ªãch (B·∫ÆT ƒê·∫¶U T·ª™ ƒê√ÇY)

| File | N·ªôi Dung | M·ª•c ƒê√≠ch |
|------|----------|----------|
| [TRADING_RULES.md](TRADING_RULES.md) | **T·ªïng h·ª£p t·∫•t c·∫£ quy t·∫Øc giao d·ªãch** | ƒê·ªçc ƒë·∫ßu ti√™n - Hi·ªÉu to√†n b·ªô quy t·∫Øc |
| [ENTRY_RULES.md](ENTRY_RULES.md) | **Quy t·∫Øc v√† ƒëi·ªÅu ki·ªán entry v√†o l·ªánh** | Hi·ªÉu khi n√†o bot entry |
| [RISK_MANAGEMENT_RULES.md](RISK_MANAGEMENT_RULES.md) | **Quy t·∫Øc qu·∫£n l√Ω v·ªën** | Hi·ªÉu c√°ch bot qu·∫£n l√Ω r·ªßi ro |
| [TRADING_SCHEDULE.md](TRADING_SCHEDULE.md) | **Th·ªùi gian giao d·ªãch** | Hi·ªÉu khi n√†o bot trade |

### T√†i Li·ªáu C·ªët L√µi

| File | N·ªôi Dung | M·ª•c ƒê√≠ch |
|------|----------|----------|
| [README.md](README.md) | T·ªïng quan d·ª± √°n | H∆∞·ªõng d·∫´n b·∫Øt ƒë·∫ßu |
| [README_V2.1.md](README_V2.1.md) | M√¥ t·∫£ phi√™n b·∫£n v2.1 | T√¨m hi·ªÉu t√≠nh nƒÉng m·ªõi |
| [01_SYSTEM_OVERVIEW.md](01_SYSTEM_OVERVIEW.md) | T·ªïng quan ki·∫øn tr√∫c 5 l·ªõp | Hi·ªÉu thi·∫øt k·∫ø h·ªá th·ªëng |
| [07_CONFIGURATION.md](07_CONFIGURATION.md) | T·∫•t c·∫£ tham s·ªë c·∫•u h√¨nh | ƒêi·ªÅu ch·ªânh c√†i ƒë·∫∑t EA |
| [09_EXAMPLES.md](09_EXAMPLES.md) | V√≠ d·ª• giao d·ªãch th·ª±c t·∫ø | H·ªçc ·ª©ng d·ª•ng chi·∫øn l∆∞·ª£c |
| [10_IMPROVEMENTS_ROADMAP.md](10_IMPROVEMENTS_ROADMAP.md) | K·∫ø ho·∫°ch c·∫£i ti·∫øn | L·∫≠p k·∫ø ho·∫°ch t∆∞∆°ng lai |

### H∆∞·ªõng D·∫´n T√≠nh NƒÉng

| File | N·ªôi Dung | M·ª•c ƒê√≠ch |
|------|------|------|
| [DCA_MECHANISM.md](DCA_MECHANISM.md) | Gi·∫£i th√≠ch c∆° ch·∫ø DCA | Hi·ªÉu logic th√™m l·ªánh |

### C·∫≠p Nh·∫≠t Phi√™n B·∫£n

| File | N·ªôi Dung | M·ª•c ƒê√≠ch |
|------|------|------|
| [V2.1_QUICK_REFERENCE.md](V2.1_QUICK_REFERENCE.md) | Tham chi·∫øu nhanh v2.1 | Tra c·ª©u t√≠nh nƒÉng m·ªõi |
| [V2.1_UPDATES_SUMMARY.md](V2.1_UPDATES_SUMMARY.md) | T√≥m t·∫Øt c·∫≠p nh·∫≠t v2.1 | Gi·∫£i th√≠ch c·∫≠p nh·∫≠t chi ti·∫øt |

---

## üîç ƒêi·ªÅu H∆∞·ªõng Nhanh

### ‚≠ê N·∫øu b·∫°n l√† Trader (mu·ªën hi·ªÉu chi·∫øn l∆∞·ª£c):

**ƒê·ªçc theo th·ª© t·ª± n√†y:**

1. üìñ [TRADING_RULES.md](TRADING_RULES.md) - **ƒê·ªåC ƒê·∫¶U TI√äN** - T·ªïng h·ª£p t·∫•t c·∫£ quy t·∫Øc
2. üìñ [ENTRY_RULES.md](ENTRY_RULES.md) - Quy t·∫Øc entry v√†o l·ªánh
3. üìñ [RISK_MANAGEMENT_RULES.md](RISK_MANAGEMENT_RULES.md) - Quy t·∫Øc qu·∫£n l√Ω v·ªën
4. üìñ [TRADING_SCHEDULE.md](TRADING_SCHEDULE.md) - Th·ªùi gian giao d·ªãch
5. üìñ [09_EXAMPLES.md](09_EXAMPLES.md) - V√≠ d·ª• giao d·ªãch th·ª±c t·∫ø
6. üìñ [07_CONFIGURATION.md](07_CONFIGURATION.md) - Tham s·ªë c·∫•u h√¨nh

### N·∫øu b·∫°n mu·ªën t√¨m hi·ªÉu t√≠nh nƒÉng m·ªõi v2.1:
1. üìñ [V2.1_UPDATES_SUMMARY.md](V2.1_UPDATES_SUMMARY.md) - T√≥m t·∫Øt c·∫≠p nh·∫≠t
2. üìñ [V2.1_QUICK_REFERENCE.md](V2.1_QUICK_REFERENCE.md) - Tham chi·∫øu nhanh
3. üìñ [README_V2.1.md](README_V2.1.md) - T·ªïng quan v2.1

### N·∫øu b·∫°n mu·ªën c·∫•u h√¨nh EA:
1. üìñ [07_CONFIGURATION.md](07_CONFIGURATION.md) - T·∫•t c·∫£ tham s·ªë
2. üìñ [TRADING_SCHEDULE.md](TRADING_SCHEDULE.md) - C·∫•u h√¨nh th·ªùi gian trade
3. üìñ [DCA_MECHANISM.md](DCA_MECHANISM.md) - C·∫•u h√¨nh DCA
4. üìñ [RISK_MANAGEMENT_RULES.md](RISK_MANAGEMENT_RULES.md) - C·∫•u h√¨nh qu·∫£n l√Ω v·ªën

---

## üíª T√†i Li·ªáu K·ªπ Thu·∫≠t

**T√†i li·ªáu chi ti·∫øt v·ªÅ code v√† thu·∫≠t to√°n** n·∫±m trong th∆∞ m·ª•c `../code_logic/`:
- Thu·∫≠t to√°n detector ‚Üí `../code_logic/02_DETECTORS.md`
- Logic scoring ‚Üí `../code_logic/03_ARBITER.md`
- Tri·ªÉn khai executor ‚Üí `../code_logic/04_EXECUTOR.md`
- Thu·∫≠t to√°n qu·∫£n l√Ω r·ªßi ro ‚Üí `../code_logic/05_RISK_MANAGER.md`
- Logic lu·ªìng ch√≠nh ‚Üí `../code_logic/08_MAIN_FLOW.md`

---

## üìù Gi·∫£i Th√≠ch T√†i Li·ªáu

**Th∆∞ m·ª•c n√†y bao g·ªìm**:
- ‚úÖ **Quy t·∫Øc giao d·ªãch** - T·∫•t c·∫£ quy t·∫Øc v√† ƒëi·ªÅu ki·ªán
- ‚úÖ **Th·ªùi gian trade** - Khi n√†o bot ƒë∆∞·ª£c ph√©p trade
- ‚úÖ **Quy t·∫Øc entry** - ƒêi·ªÅu ki·ªán v√† c√°ch entry v√†o l·ªánh
- ‚úÖ **Qu·∫£n l√Ω v·ªën** - C√°ch bot qu·∫£n l√Ω r·ªßi ro v√† v·ªën
- ‚úÖ **DCA mechanism** - C√°ch bot th√™m l·ªánh
- ‚úÖ Kh√°i ni·ªám v√† chi·∫øn l∆∞·ª£c ·ªü c·∫•p ƒë·ªô kinh doanh
- ‚úÖ H∆∞·ªõng d·∫´n tham s·ªë c·∫•u h√¨nh v√† s·ª≠ d·ª•ng
- ‚úÖ V√≠ d·ª• giao d·ªãch th·ª±c t·∫ø
- ‚úÖ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng t√≠nh nƒÉng
- ‚úÖ T√≥m t·∫Øt c·∫≠p nh·∫≠t phi√™n b·∫£n

**Kh√¥ng bao g·ªìm**:
- ‚ùå Tri·ªÉn khai code chi ti·∫øt (xem `code_logic/`)
- ‚ùå Chi ti·∫øt k·ªπ thu·∫≠t thu·∫≠t to√°n (xem `code_logic/`)
- ‚ùå S·ª≠a l·ªói ·ªü c·∫•p ƒë·ªô code (xem `code_logic/`)

---

## Ki·∫øn Tr√∫c 5 L·ªõp

```
                     MARKET DATA
                          |
                          v
+----------------------------------------------------------+
|  1. DETECTION LAYER (detectors.mqh)                      |
|     BOS | Sweep | Order Block | FVG | Momentum           |
+----------------------------------------------------------+
                          |
                          v
+----------------------------------------------------------+
|  2. ARBITRATION LAYER (arbiter.mqh)                      |
|     BuildCandidate() -> ScoreCandidate() -> Filter       |
+----------------------------------------------------------+
                          |
                          v
+----------------------------------------------------------+
|  3. EXECUTION LAYER (executor.mqh)                       |
|     Session | Spread | Trigger | Entry/SL/TP | Order     |
+----------------------------------------------------------+
                          |
                          v
+----------------------------------------------------------+
|  4. RISK MANAGEMENT LAYER (risk_manager.mqh)             |
|     Lot Size | DCA | BE | Trail | MDD | Basket           |
+----------------------------------------------------------+
                          |
                          v
+----------------------------------------------------------+
|  5. ANALYTICS LAYER (stats_manager.mqh)                  |
|     Track Trades | Statistics | Dashboard                |
+----------------------------------------------------------+
```

---

## Lu·ªìng Ho·∫°t ƒê·ªông Ch√≠nh

### OnTick() Flow
```
1. Check new bar
2. Pre-checks: Session? Spread? MDD? Rollover?
3. Run detectors: BOS, Sweep, OB, FVG, Momentum
4. Build & Score Candidate
5. If score >= 100: Find trigger -> Calculate Entry/SL/TP -> Place order
6. Manage existing positions: BE, Trailing, DCA
7. Update dashboard
```

### Entry Decision Tree
```
Signal Detected
     |
     v
Valid Candidate? --- NO ---> Skip
     |
    YES
     |
     v
Score >= 100? --- NO ---> Skip (low quality)
     |
    YES
     |
     v
Momentum Against SMC? --- YES ---> Disqualify
     |
     NO
     |
     v
Session & Spread OK? --- NO ---> Wait
     |
    YES
     |
     v
Trigger Candle Found? --- NO ---> Wait
     |
    YES
     |
     v
   ENTRY (OK)
```

---

## H·ªá Th·ªëng Scoring (ƒêi·ªÉm T·ªëi Thi·ªÉu: 100)

### ƒêi·ªÉm C∆° B·∫£n
| Component | ƒêi·ªÉm | ƒêi·ªÅu Ki·ªán |
|-----------|------|-----------|
| Base | +100 | BOS + (OB ho·∫∑c FVG) |
| BOS | +40 | Valid BOS detected |
| Order Block | +35 | Valid OB |
| FVG | +30 | Valid FVG (state = 0) |
| Sweep | +25 | Valid liquidity sweep |

### Bonus
| Bonus | ƒêi·ªÉm | ƒêi·ªÅu Ki·ªán |
|-------|------|-----------|
| Sweep g·∫ßn (<0.5 ATR) | +25 | Sweep proximity |
| MTF Aligned | +25 | C√πng h∆∞·ªõng H1/H4 |
| OB c√≥ Sweep | +20-25 | Sweep trong/g·∫ßn OB |
| FVG MTF Overlap | +20-30 | FVG subset c·ªßa HTF |
| BOS Retest | +12-20 | 1-2+ l·∫ßn retest |
| Fresh POI | +10 | OB 0 touches / FVG state=0 |
| London/NY Session | +8-10 | High liquidity time |

### Penalties
| Penalty | ƒêi·ªÉm | ƒêi·ªÅu Ki·ªán |
|---------|------|-----------|
| Counter-trend MTF | -40 | Ng∆∞·ª£c H1/H4 |
| OB nhi·ªÅu touches | -20 | touches >= 2 |
| FVG Mitigated | -15 | state = 1 |
| OB Weak | -10 | Volume < 1.3x avg |
| BOS no retest | -8 | Direct breakout |

---

## DCA (Dollar Cost Averaging)

### Trigger Levels
| Level | Trigger | Lot Size |
|-------|---------|----------|
| DCA #1 | +0.75R profit | 0.5x original |
| DCA #2 | +1.5R profit | 0.33x original |

### Quy T·∫Øc Quan Tr·ªçng
- **R ƒë∆∞·ª£c t√≠nh d·ª±a tr√™n ORIGINAL SL** (kh√¥ng ƒë·ªïi d√π SL ƒë√£ move v·ªÅ BE)
- Sync SL cho t·∫•t c·∫£ positions c√πng side
- Check equity health tr∆∞·ªõc khi DCA

---

## Qu·∫£n L√Ω V·ªã Th·∫ø

### Breakeven
- Trigger: +1R profit
- Action: Move SL v·ªÅ entry price

### Trailing Stop
- Start: +1R profit
- Step: +0.5R m·ªói l·∫ßn move
- Distance: 2x ATR t·ª´ current price

### Daily MDD
- Limit: 8% daily drawdown
- Action: Close all + Halt trading ƒë·∫øn ng√†y h√¥m sau

---

## C·∫•u H√¨nh Session

### Mode 1: Full Day (7h-23h GMT+7)
```
07:00 ================================================ 23:00
      |---------------- 16 hours continuous --------------|
```

### Mode 2: Multi-Window
```
07:00 ==== 11:00    12:00 ==== 16:00    18:00 ======== 23:00
      | Asia | break | London | break |      NY       |
```

---

## C·∫•u H√¨nh Kh·ªüi ƒê·ªông Nhanh

### Conservative (T√†i kho·∫£n < $5k)
```
Risk: 0.2%
MDD: 5%
DCA: Disabled
MaxLot: 2.0
```

### Balanced (T√†i kho·∫£n $5k-$20k) - Khuy·∫øn ngh·ªã
```
Risk: 0.3-0.5%
MDD: 8%
DCA: Enabled (2 levels)
MaxLot: 3.0
```

### Aggressive (T√†i kho·∫£n > $20k)
```
Risk: 0.5-1%
MDD: 10-12%
DCA: Enabled (3 levels)
MaxLot: 5.0
```

---

## Files Quan Tr·ªçng

| File | M√¥ T·∫£ |
|------|-------|
| `Experts/[EA].mq5` | Main EA file |
| `Include/detectors.mqh` | Signal detection |
| `Include/arbiter.mqh` | Scoring & filtering |
| `Include/executor.mqh` | Order execution |
| `Include/risk_manager.mqh` | Risk management |
| `Include/stats_manager.mqh` | Statistics & dashboard |

---

## L·ªãch S·ª≠ Phi√™n B·∫£n

- **v1.2**: Base SMC/ICT detection, DCA, BE, Trail
- **v2.0**: News filter, Volatility regime, Adaptive parameters
- **v2.1**: OB Sweep validation, FVG MTF overlap, BOS retest tracking

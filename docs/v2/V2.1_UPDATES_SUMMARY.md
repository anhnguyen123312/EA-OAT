# v2.1 Updates Summary - Advanced ICT Detection & Scoring

## üìç T·ªïng Quan

Version 2.1 b·ªï sung 4 t√≠nh nƒÉng n√¢ng cao d·ª±a tr√™n best practices c·ªßa ICT/SMC ƒë·ªÉ tƒÉng ƒë·ªô tin c·∫≠y c·ªßa setup v√† optimize RR ratio.

**Version**: v2.1  
**Date**: October 2025  
**Status**: Documentation Complete - Ready for Implementation

---

## üÜï T√≠nh NƒÉng M·ªõi

### 1. OB v·ªõi Sweep Validation üíé

#### üéØ M·ª•c ƒê√≠ch
X√°c nh·∫≠n Order Block c√≥ liquidity sweep li√™n quan, t·∫°o confluence m·∫°nh theo chu·∫©n ICT.

#### üìù Logic
- **Bullish OB**: Ph·∫£i c√≥ **Sell-Side Sweep** b√™n d∆∞·ªõi ho·∫∑c trong OB zone
- **Bearish OB**: Ph·∫£i c√≥ **Buy-Side Sweep** b√™n tr√™n ho·∫∑c trong OB zone
- **Quality Score**: T√≠nh d·ª±a tr√™n kho·∫£ng c√°ch sweep - OB (c√†ng g·∫ßn c√†ng t·ªët)

#### üí° ƒêi·ªÅu Ki·ªán Chi Ti·∫øt

| Sweep Position | Distance | Quality Score | Bonus Points |
|---------------|----------|---------------|--------------|
| **Inside OB Zone** | 0 pts | 0.8 | +25 + 10 = **+35** ‚≠ê‚≠ê‚≠ê |
| **0-50 pts from OB** | ‚â§50 pts | 0.8-1.0 | **+25** ‚≠ê‚≠ê |
| **50-100 pts from OB** | 50-100 pts | 0.5-0.8 | **+15** ‚≠ê |
| **100-200 pts from OB** | 100-200 pts | 0.0-0.5 | **+10** |
| **> 200 pts from OB** | >200 pts | 0.0 | **No bonus** ‚ö†Ô∏è |

#### üìä Impact
```
Win Rate Impact: +5-8%
Reason: Filter OB without liquidity confirmation
```

#### üìñ Chi Ti·∫øt
- File docs: `02_DETECTORS.md` (Section: OB v·ªõi Sweep Validation)
- File docs: `03_ARBITER.md` (Section: OB Sweep Validation Scoring)

---

### 2. FVG MTF Overlap (Subset Validation) üéØ

#### üéØ M·ª•c ƒê√≠ch
X√°c nh·∫≠n FVG tr√™n LTF (M15/M30) l√† **t·∫≠p con** c·ªßa FVG tr√™n HTF (H1/H4), t·∫°o confluence r·∫•t m·∫°nh.

#### üìù Logic
- **Subset Requirement**: LTF FVG ph·∫£i **N·∫∞M TRONG** HTF FVG
- **Same Direction**: C·∫£ 2 FVG ph·∫£i c√πng direction (bullish/bearish)
- **Tolerance**: Cho ph√©p ch√™nh l·ªách ¬±50 points

#### üí° ƒêi·ªÅu Ki·ªán Chi Ti·∫øt

| Overlap Ratio | Confidence | HTF Period | Bonus Points |
|--------------|-----------|------------|--------------|
| **‚â•0.7 (70%+)** | Very High | H1 | **+30** ‚≠ê‚≠ê‚≠ê |
| **‚â•0.7 (70%+)** | Very High | H4 | **+30 + 10 = +40** ‚≠ê‚≠ê‚≠ê‚≠ê |
| **0.4-0.7 (40-70%)** | High | H1/H4 | **+20** ‚≠ê‚≠ê |
| **<0.4 (<40%)** | Medium | H1/H4 | **+15** ‚≠ê |
| **No Overlap** | Low | - | **-5** ‚ö†Ô∏è |

#### üìä C√¥ng Th·ª©c Overlap Ratio
```cpp
overlapRatio = (LTF_FVG_Size) / (HTF_FVG_Size)

Example:
  LTF: 2647.00 - 2649.00 = 200 pts
  HTF: 2646.00 - 2650.00 = 400 pts
  Ratio = 200 / 400 = 0.5 (50%)
```

#### üìä Impact
```
Win Rate Impact: +6-10%
RR Improvement: +0.5-1.0
Reason: HTF support = higher probability + better entry
```

#### üìñ Chi Ti·∫øt
- File docs: `02_DETECTORS.md` (Section: FVG MTF Overlap)
- File docs: `03_ARBITER.md` (Section: FVG MTF Overlap Scoring)

---

### 3. BOS Retest Tracking üîÑ

#### üéØ M·ª•c ƒê√≠ch
Track s·ªë l·∫ßn price retest BOS level ƒë·ªÉ x√°c nh·∫≠n ƒë·ªô m·∫°nh c·ªßa structure break.

#### üìù Logic
- **Retest Zone**: ¬±30 points t·ª´ BOS level
- **Count**: ƒê·∫øm s·ªë l·∫ßn price close trong retest zone
- **Minimum Gap**: M·ªói retest c√°ch nhau √≠t nh·∫•t 3 bars

#### üí° Retest Scoring

| Retest Count | Strength Score | Bonus/Penalty | Notes |
|-------------|---------------|---------------|-------|
| **0 (No Retest)** | 0.0 | **-8** ‚ö†Ô∏è | Direct breakout, higher risk |
| **+ No WAE/Momo** | 0.0 | **-8 - 10 = -18** ‚ùå | Very risky |
| **1 Retest** | 0.7 | **+12** ‚≠ê | Good confirmation |
| **2 Retest** | 0.9 | **+20** ‚≠ê‚≠ê | Strong level |
| **2+ Retest + OB** | 0.9 | **+20 + 10 = +30** ‚≠ê‚≠ê‚≠ê | Ultimate setup |
| **3+ Retest** | 1.0 | **+20** ‚≠ê‚≠ê | Excellent level |

#### üìä Impact
```
Win Rate Impact: +3-5%
False Breakout Reduction: -40-50%
Reason: Retest confirms level validity
```

#### üìñ Chi Ti·∫øt
- File docs: `02_DETECTORS.md` (Section: BOS Retest Tracking)
- File docs: `03_ARBITER.md` (Section: BOS Retest Scoring)

---

### 4. Entry Method Based on Pattern üìç

#### üéØ M·ª•c ƒê√≠ch
S·ª≠ d·ª•ng entry method ph√π h·ª£p v·ªõi t·ª´ng pattern ƒë·ªÉ optimize RR v√† fill rate.

#### üìù Entry Decision Matrix

| Pattern | Entry Type | Entry Price | RR Expected | Fill Rate | Win Rate |
|---------|-----------|-------------|-------------|-----------|----------|
| **FVG + BOS** | LIMIT | FVG bottom/top | **3.5-4.0** | 60-70% | 72-75% |
| **OB + BOS + Retest** | LIMIT | OB bottom/top | **3.0-3.5** | 70-80% | 68-72% |
| **Sweep + BOS + OB** | LIMIT | OB bottom/top | **3.0-3.5** | 70-80% | 68-72% |
| **Sweep + BOS (No POI)** | STOP | Trigger + buffer | **2.0-2.5** | 95-100% | 65-68% |
| **BOS only (CHOCH)** | STOP | Trigger + buffer | **1.8-2.2** | 95-100% | 63-66% |
| **OB + BOS (No retest)** | LIMIT | OB bottom/top | **2.8-3.2** | 70-80% | 66-70% |

#### üí° Priority Logic

```
PRIORITY 1: FVG
  ‚Üí Has FVG + Fresh (state 0)
  ‚Üí Use LIMIT at FVG bottom (LONG) / top (SHORT)
  ‚Üí Best RR: 3.5-4.0

PRIORITY 2: OB with Retest
  ‚Üí Has OB + BOS + Retest ‚â•1
  ‚Üí Use LIMIT at OB bottom/top
  ‚Üí Good RR: 3.0-3.5

PRIORITY 3: Sweep + BOS (Momentum)
  ‚Üí Has Sweep + BOS
  ‚Üí Use STOP at trigger high/low + buffer
  ‚Üí Medium RR: 2.0-2.5, High fill rate

PRIORITY 4: BOS only (CHOCH)
  ‚Üí Has BOS, No OB/FVG
  ‚Üí Use STOP at trigger + buffer
  ‚Üí Lower RR: 1.8-2.2, Chase momentum

DEFAULT: OB
  ‚Üí Has OB
  ‚Üí Use LIMIT at OB bottom/top
  ‚Üí Medium RR: 2.8-3.2
```

#### üìä Impact
```
Avg RR Improvement: +0.5-1.0
Win Rate Impact: +2-4%
Reason: Better entry price = tighter SL = higher RR
```

#### üìñ Chi Ti·∫øt
- File docs: `02_DETECTORS.md` (Section: Entry Method Based on Pattern)
- File docs: `03_ARBITER.md` (Section: Entry Method Integration)

---

## üìä Combined Impact Analysis

### Before vs After v2.1

| Metric | v1.2 (Current) | v2.1 (Proposed) | Change |
|--------|---------------|----------------|--------|
| **Win Rate** | 65% | **72-75%** | **+7-10%** ‚≠ê‚≠ê‚≠ê |
| **Profit Factor** | 2.0 | **2.3-2.6** | **+15-30%** ‚≠ê‚≠ê‚≠ê |
| **Avg RR** | 2.0 | **3.0-3.5** | **+50-75%** ‚≠ê‚≠ê‚≠ê |
| **Trades/Day** | 5-6 | **3-4** | **-30-40%** (fewer but better) |
| **Max DD** | 8% | **‚â§8%** | **No increase** ‚úì |
| **False Signals** | 25-30% | **10-15%** | **-50-60%** ‚≠ê‚≠ê |

### Score Distribution Changes

#### v1.2 (Current):
```
Score Range       | % of Setups
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
100-150 (OK)      | 45%  ‚Üê Nhi·ªÅu setup trung b√¨nh
150-200 (Good)    | 35%
200+ (Excellent)  | 20%  ‚Üê √çt setup xu·∫•t s·∫Øc
```

#### v2.1 (Proposed):
```
Score Range       | % of Setups
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
100-150 (OK)      | 20%  ‚Üê Gi·∫£m setup trung b√¨nh
150-200 (Good)    | 40%
200+ (Excellent)  | 40%  ‚Üê TƒÉng setup xu·∫•t s·∫Øc ‚≠ê
```

---

## üéØ Setup Examples v2.1

### Example 1: ULTIMATE SETUP (Score: 415) ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

```
Signals:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì BOS: Bullish at 2654.00
‚úì BOS Retest: 2 times (retestStrength: 0.9)
‚úì Sweep: Sell-side at 2648.70
‚úì OB: 2649.00-2649.50 (Fresh, 0 touches)
‚úì OB Sweep: INSIDE OB zone (quality: 1.0) üíé
‚úì FVG: 2648.80-2650.00 (Fresh)
‚úì FVG MTF: H1 overlap (ratio: 0.75) üéØ
‚úì MTF Bias: Bullish (H1 uptrend)
‚úì WAE: Exploding (1.2)
‚úì MA: Aligned (EMA 20 > 50)
Time: 14:30 GMT+7 (London window)

Scoring:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BASE SCORES:
  BOS + OB/FVG                       = +100
  BOS Bonus                          = +40
  OB Bonus                           = +35
  FVG Valid                          = +30
  Sweep Bonus                        = +25

ADVANCED BONUSES (v2.1):
  OB Perfect Sweep (inside zone)     = +25 üíé
  Sweep Inside OB                    = +10 üíé
  FVG Perfect MTF (0.75)             = +30 üéØ
  BOS 2+ Retest                      = +20 üîÑ
  OB at Retest Zone                  = +10
  
OTHER BONUSES:
  MTF Aligned                        = +25
  WAE Explosion                      = +20
  MA Aligned                         = +25
  London Window                      = +10
  Fresh OB                           = +10
  
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
TOTAL SCORE:                         = 415 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

Entry:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Method: LIMIT (FVG Priority)
Entry:  2648.80 (FVG bottom)
SL:     2648.50 (sweep level)
TP:     2658.80 (1000 pts target)

Risk:   30 pts ($30 per 0.01 lot)
Reward: 1000 pts ($100 per 0.01 lot)
RR:     33:1 ‚ú®‚ú®‚ú®‚ú®‚ú®

Expected:
  Win Rate: 85%+
  Fill Rate: 65%
  Quality: ULTIMATE
```

---

### Example 2: EXCELLENT SETUP (Score: 210) ‚≠ê‚≠ê‚≠ê

```
Signals:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì BOS: Bullish
‚úì Sweep: Sell-side at 2649.20
‚úì OB: 2649.00-2649.50
‚úì OB Sweep: INSIDE OB zone (quality: 0.8) üíé
‚úì MTF Bias: Bullish

Scoring:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Base: BOS + OB                       = +100
BOS                                  = +40
OB                                   = +35
OB Perfect Sweep (inside)            = +25 üíé
Sweep Inside OB                      = +10 üíé
MTF Aligned                          = +0
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
TOTAL:                               = 210 ‚≠ê‚≠ê‚≠ê

Entry:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Method: LIMIT (OB)
Entry:  2649.00 (OB bottom)
SL:     2648.70 (sweep level)
TP:     2655.00 (600 pts target)

RR: 600 / 30 = 20:1 ‚ú®‚ú®‚ú®

Expected:
  Win Rate: 75%+
  Fill Rate: 75%
  Quality: EXCELLENT
```

---

### Example 3: GOOD SETUP (Score: 177) ‚≠ê‚≠ê

```
Signals:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì BOS: Bullish at 2654.00
‚úì BOS Retest: 1 time (retestStrength: 0.7) üîÑ
‚úì Sweep: Sell-side below BOS
‚úì OB: 2653.50-2654.00

Scoring:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Base: BOS + OB                       = +100
BOS                                  = +40
Sweep                                = +25
BOS 1 Retest                         = +12 üîÑ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
TOTAL:                               = 177 ‚≠ê‚≠ê

Entry:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Method: LIMIT (OB Retest)
Entry:  2653.50 (OB bottom)
SL:     2653.00 (sweep level)
TP:     2659.00 (550 pts target)

RR: 550 / 50 = 11:1 ‚ú®‚ú®

Expected:
  Win Rate: 68-72%
  Fill Rate: 70%
  Quality: GOOD
```

---

### Example 4: WEAK SETUP (Score: 157) ‚ö†Ô∏è

```
Signals:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì BOS: Bullish at 2654.00
‚úó BOS Retest: None (direct breakout) üîÑ
‚úó WAE: Not exploding
‚úó Momentum: Weak

Scoring:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Base: BOS + OB                       = +100
BOS                                  = +40
OB                                   = +35
BOS No Retest                        = -8 ‚ö†Ô∏è
No Momentum Confirmation             = -10 ‚ö†Ô∏è
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
TOTAL:                               = 157 ‚ö†Ô∏è

Action:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Üí SKIP if score threshold > 160
‚Üí Or wait for retest/momentum
‚Üí Lower confidence setup
```

---

## üõ†Ô∏è Implementation Checklist

### Phase 1: Detector Updates
- [ ] **OB Sweep Validation**
  - [ ] Add fields to `OrderBlock` struct
  - [ ] Implement `FindOBWithSweep()` function
  - [ ] Test sweep distance calculation
  - [ ] Test quality scoring (0-1)

- [ ] **FVG MTF Overlap**
  - [ ] Add fields to `FVGSignal` struct
  - [ ] Implement `CheckFVGMTFOverlap()` function
  - [ ] Test subset validation logic
  - [ ] Test tolerance handling (¬±50 pts)

- [ ] **BOS Retest**
  - [ ] Add fields to `BOSSignal` struct
  - [ ] Implement `UpdateBOSRetest()` function
  - [ ] Test retest counting (3 bars gap)
  - [ ] Test strength calculation

- [ ] **Entry Method**
  - [ ] Add `ENTRY_TYPE` enum
  - [ ] Add `EntryConfig` struct
  - [ ] Implement `DetermineEntryMethod()` function
  - [ ] Test priority logic

### Phase 2: Arbiter Updates
- [ ] **Candidate struct**
  - [ ] Add OB sweep fields
  - [ ] Add FVG MTF fields
  - [ ] Add BOS retest fields

- [ ] **BuildCandidate()**
  - [ ] Integrate OB sweep check
  - [ ] Integrate FVG MTF check
  - [ ] Integrate BOS retest update

- [ ] **ScoreCandidate()**
  - [ ] Add OB sweep scoring
  - [ ] Add FVG MTF scoring
  - [ ] Add BOS retest scoring

### Phase 3: Executor Updates
- [ ] **ExecuteEntry()**
  - [ ] Call `DetermineEntryMethod()`
  - [ ] Route to LIMIT or STOP order
  - [ ] Test entry price calculation

- [ ] **PlaceLimitOrder()**
  - [ ] Implement limit order logic
  - [ ] Set TTL (24-48 bars)
  - [ ] Validate entry < current price (LONG)

### Phase 4: Testing
- [ ] **Unit Tests** (Each feature)
  - [ ] Test on historical data (1 week)
  - [ ] Visual verification on chart
  - [ ] Verify calculations

- [ ] **Integration Test** (All features)
  - [ ] Backtest 3 months (Jun-Aug 2024)
  - [ ] Compare metrics vs v1.2
  - [ ] Check conflicts

- [ ] **Forward Test**
  - [ ] Demo account (2 weeks)
  - [ ] Monitor fill rates
  - [ ] Monitor slippage
  - [ ] Monitor win rate vs backtest

---

## üìä Parameters v2.1

### New Input Parameters

```cpp
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// OB SWEEP VALIDATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
input group "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê OB Sweep Validation ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
input bool   InpOBRequireSweep    = true;    // Require sweep for OB
input int    InpOBSweepMaxDist    = 100;     // Max sweep distance (pts)
input double InpOBSweepMinQuality = 0.5;     // Min sweep quality (0-1)

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FVG MTF OVERLAP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
input group "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FVG MTF Overlap ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
input bool   InpFVGRequireMTF     = false;   // Require MTF overlap
input double InpFVGTolerance      = 50;      // Tolerance (pts)
input int    InpFVGHTFMinSize     = 200;     // HTF FVG min size (pts)

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BOS RETEST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
input group "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BOS Retest ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
input bool   InpBOSTrackRetest    = true;    // Track BOS retest
input int    InpBOSRetestTolerance= 30;      // Retest zone (pts)
input int    InpBOSRetestMinGap   = 3;       // Min bars between retest

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ENTRY METHOD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
input group "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Entry Method ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
input bool   InpAutoEntryMethod   = true;    // Auto-determine entry type
input bool   InpPreferLimit       = true;    // Prefer LIMIT when possible
input int    InpLimitOrderTTL     = 24;      // Limit order TTL (bars)
```

### Scoring Weights (New)

```cpp
// OB Sweep Bonuses
#define SCORE_OB_SWEEP_PERFECT     25    // Quality ‚â•0.8
#define SCORE_OB_SWEEP_INSIDE      10    // Sweep inside OB
#define SCORE_OB_SWEEP_GOOD        15    // Quality 0.5-0.8
#define SCORE_OB_SWEEP_OK          10    // Quality <0.5
#define SCORE_OB_NO_SWEEP         -10    // OB without sweep

// FVG MTF Bonuses
#define SCORE_FVG_MTF_PERFECT      30    // Ratio ‚â•0.7
#define SCORE_FVG_MTF_H4_BONUS     10    // Extra for H4
#define SCORE_FVG_MTF_GOOD         20    // Ratio 0.4-0.7
#define SCORE_FVG_MTF_OK           15    // Ratio <0.4
#define SCORE_FVG_NO_MTF           -5    // No HTF support

// BOS Retest Bonuses
#define SCORE_BOS_RETEST_2PLUS     20    // 2+ retest
#define SCORE_BOS_RETEST_OB_BONUS  10    // OB at retest zone
#define SCORE_BOS_RETEST_1         12    // 1 retest
#define SCORE_BOS_NO_RETEST        -8    // No retest
#define SCORE_BOS_NO_MOMENTUM     -10    // No retest + no WAE/Momo
```

---

## üìö Documentation Files

| File | Section | Content |
|------|---------|---------|
| `02_DETECTORS.md` | v2.1 Advanced Detection | ‚Ä¢ OB Sweep Validation<br>‚Ä¢ FVG MTF Overlap<br>‚Ä¢ BOS Retest Tracking<br>‚Ä¢ Entry Method Logic |
| `03_ARBITER.md` | v2.1 Advanced Scoring | ‚Ä¢ OB Sweep Scoring<br>‚Ä¢ FVG MTF Scoring<br>‚Ä¢ BOS Retest Scoring<br>‚Ä¢ Entry Method Integration |
| `V2.1_UPDATES_SUMMARY.md` | This file | ‚Ä¢ Overview<br>‚Ä¢ Examples<br>‚Ä¢ Implementation checklist |

---

## üéØ Expected Results (Conservative Estimate)

### After Full v2.1 Implementation

```
Current State (v1.2):
  Win Rate:         65%
  Profit Factor:    2.0
  Avg RR:           2.0
  Trades/Day:       5-6
  Max DD:           8%

Target State (v2.1):
  Win Rate:         72-75%  (+7-10%) ‚≠ê‚≠ê‚≠ê
  Profit Factor:    2.3-2.6 (+15-30%) ‚≠ê‚≠ê‚≠ê
  Avg RR:           3.0-3.5 (+50-75%) ‚≠ê‚≠ê‚≠ê
  Trades/Day:       3-4     (-30-40%, higher quality)
  Max DD:           ‚â§8%     (no increase) ‚úì

Quality Improvements:
  False Signals:    -50-60% ‚≠ê‚≠ê
  Ultimate Setups:  +100%   (20% ‚Üí 40%) ‚≠ê‚≠ê‚≠ê
  Avg Score:        +30-50 points
  Confluence:       3-4 factors minimum (vs 2)
```

---

## üöÄ Next Steps

### Week 1-2: Core Implementation
1. ‚úÖ Documentation complete
2. ‚è≥ Update `detectors.mqh` with new functions
3. ‚è≥ Update `arbiter.mqh` with new scoring
4. ‚è≥ Add new input parameters

### Week 3: Testing
1. ‚è≥ Unit test each feature
2. ‚è≥ Visual test on chart (1 week data)
3. ‚è≥ Fix bugs

### Week 4: Integration
1. ‚è≥ Backtest 3 months (Jun-Aug 2024)
2. ‚è≥ Compare with v1.2 baseline
3. ‚è≥ Tune parameters

### Week 5: Validation
1. ‚è≥ Forward test (demo, 2 weeks)
2. ‚è≥ Monitor metrics
3. ‚è≥ Final adjustments

### Week 6: Production
1. ‚è≥ Live small lot (if forward test OK)
2. ‚è≥ Monitor 1 week
3. ‚è≥ Scale up if successful

---

## üìû Support

N·∫øu c√≥ th·∫Øc m·∫Øc v·ªÅ implementation:
1. ƒê·ªçc l·∫°i `02_DETECTORS.md` (thu·∫≠t to√°n chi ti·∫øt)
2. ƒê·ªçc l·∫°i `03_ARBITER.md` (scoring logic)
3. Xem examples trong file n√†y

---

**Version**: v2.1 Documentation  
**Status**: Complete ‚úÖ  
**Ready for**: Implementation  
**Estimated Time**: 4-6 weeks full implementation + testing

